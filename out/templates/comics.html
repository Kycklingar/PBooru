{{template "base"}}

{{if .User.Flag.Comics}}
<details>
<summary>Create a new comic</summary>
	<form method="post">
		<input placeholder="Title" type="text" name="title">
		<br>
		<input type="submit">
	</form>
</details>
<form>
	<input type="hidden" name="edit">
	<input type="submit" value="Edit">
</form>
{{end}}

<div>
	<form class="center" action="/comics/">
		<input type="text" name="title" placeholder="Title" value="{{.Query.title}}">
		<br>
		<input class="stinput" type="text" name="tags" placeholder="Tags" value="{{.Query.tags}}">
		<br>
		<input type="submit" value="Search">
	</form>
</div>

<script type="text/javascript" src="/static/suggestions.js"></script>

{{range .Comics}}
<div class="comics-container">
        <a href="/comic/{{.ID}}">
            <h2>{{.Title}}</h2>
        </a>
        <p>Pages:{{.PageCount}}<br>Chapters:{{.ChapterCount}}</p>
	{{range .ChaptersLimit 1}}
        	<h3><a href="/comic/{{.Comic.ID}}/{{.Order}}">Chapter {{.Order}}</a>{{if .Title}} - {{.Title}}{{end}}</h3>
        	<div class="cpage-container">
        		{{template "chapterPosts" wrap2 "UserInfo" "Posts" $.UserInfo (.PostsLimit 5)}}
		</div>
	{{end}}

	{{if $.Edit}}
	<details>
	<summary>Edit</summary>
	<form action="/comic/edit/" method="POST">
		<input type="hidden" name="comic-id" value="{{.ID}}">
		<label>Title</label><br>
		<input type="text" name="title" value="{{.Title}}"><br>
		<input type="submit">
	</form>
	<form action="/comic/delete/" method="POST">
		<input type="hidden" value="{{.ID}}" name="comic-id">
		<input type="submit" value="Delete">
	</form>
	</details>
	{{end}}
</div>
{{end}}

<div class="nolink" id="pageinator">
    {{ if ne 0 $.Pageinator.Prev}}
        <a href="/comics/{{.Pageinator.First}}/{{.Query.Encode}}">
            First
        </a>
    
        <a href="/comics/{{$.Pageinator.Prev}}/{{.Query.Encode}}" id="prev">
            Previous
        </a>
    {{ end }}
    {{ range .Pageinator.Pages }}
        <span>
            {{ if eq $.Pageinator.Current . }}
            <span style="font-size:25px;">
                {{.}}
            </span>
            {{ else }}
            <a href="/comics/{{.}}/{{$.Query.Encode}}">
                {{.}}
            </a>
            {{ end }}
        </span>
    {{ end }}
    {{ if ne 0 $.Pageinator.Next}}
        <a href="/comics/{{.Pageinator.Next}}/{{.Query.Encode}}">
            Next
        </a>
        <a href="/comics/{{.Pageinator.Last}}/{{.Query.Encode}}">
            Last
        </a>
    {{ end }}
</div>

{{template "userSettings" .UserInfo}}

{{template "benchmark" .Time}}

{{template "baseEnd"}}
