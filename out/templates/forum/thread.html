{{template "forum-base"}}
<div class="forum">
	<div id="threader">
		<div class="thread">
			{{range .Thread.Posts}}
				<div id="{{.Id}}" class="thread-post">
					<span class="thread-username">{{with .Poster}}<a href="/user/{{.ID}}">{{.Name}}</a> <span class="clickable" onClick="appendReply('@{{.ID}}')">@{{.ID}}</span>{{else}}Anonymous{{end}}</span>
					<span class="thread-id clickable" onClick="appendReply('>>{{.Id}}')">#{{.Id}}</span>
					<span class="thread-timestamp" title="{{.Created}}">{{.Created.Elapsed}}</span>

					{{if $.User.Flag.Special}}
					<details>
					<summary> </summary>
						<form action="/forum/delete/post/" method="POST">
							<input type="hidden" name="reply" value="{{.Id}}">
							<input type="hidden" name="board" value="{{$.Board.Uri}}">
							<input type="submit" value="Delete">
						</form>
					</details>
					{{end}}

					<h3 class="title">{{.Title}}</h3>
					<span>{{.CompiledWithRefs | noescape}}</span>
					{{/*
					<!--
					<span class="backlink">
						{{range .Backlinks}}
						<a href="#{{.}}">>>{{.}}</a>
						{{end}}
					</span>
					-->
					*/}}
				</div>
			{{end}}
		</div>
		<details open>
		<summary>Reply</summary>
			<div class="reply-box">
				<div class="reply form">
					{{template "forum-banner" .Board}}
					<div id="reply">
						<form action="/forum/new/post/" method="POST">
							<input name="reply-to" type="hidden" value="{{.Thread.Id}}">
							<input name="board" type="hidden" value="{{.Board.Uri}}">
							<textarea rows="10" cols="30" name="body" type="text" placeholder="Text"></textarea>
							<input type="submit" value="Reply">
						</form>
					</div>
				</div>
			</div>
		</details>
	</div>
</div>

<script>
let replyInput = document.getElementById("reply").getElementsByTagName("textarea")[0]

function appendReply(str)
{
	replyInput.value += str
}
</script>
{{template "baseEnd"}}
