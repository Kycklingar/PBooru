{{template "base"}}


<style>
	#interface-window
	{
		position:fixed;
		display:flex;
		background-color:#222B;
		bottom:0px;
		left:0px;
		right:0px;
		top:0px;
	}

	.x
	{
		background-color:#333A;
		padding:2px;
		position:absolute;
		top:0px;
		right:0px;

		cursor:pointer;
	}

	#interface-left
	{
		background-color:#111;
		width:150px;
		overflow:auto;
		padding:5px;
	}

	#interface-left img
	{
		width:100%;
	}

	#interface-left p
	{
		margin:0px;
		padding:0px;
	}

	#interface-right
	{
		/*width:100%;*/
		overflow: auto;
		width:100%;
	}

	#interface-float
	{
		background-color:#333A;
		position:fixed;
		right:0px;
		bottom:0px;
		margin:1em;
	}

	#interface-float span
	{
		cursor:pointer;
	}

	#interface-float-left
	{
		background-color:#333A;
		position:absolute;
		bottom:0px;
		margin:1em;
	}

	#interface-float-left details
	{
		padding-left:1em;
	}

	#interface-float-left div
	{
		padding-left:1em;
	}

	.highlighted
	{
		background-color:#3A3A3A;
		box-shadow:0px 0px 4px #CCC;
		z-index: 1;
		text-shadow: 2px 1px 2px black;
	}

	#canvas
	{
		position:relative;
		image-rendering: crisp-edges;
	}

	#canvas img
	{
		width:100%;
		height:100%;
	}

	.fit-image img
	{
		object-fit: contain;
		object-position: top left;
	}

	.fit-image
	{
		max-width: 100%;
		max-height: 100%;
	}

	.hidden
	{
		display:none;
	}

	#loader
	{
		position: fixed;
		top: 50%;
		left: 50%;
		border: 16px solid grey;
		border-top: 16px solid blue;
		border-radius: 50%;
		width: 120px;
		height: 120px;
		opacity: 0.75;
		animation: spin 1s linear infinite;
	}

	@keyframes spin
	{
		0% { transform: rotate(0deg); }
		100% { transform: rotate(360deg); }
	}
</style>

<div id="interface-window">
	<div id="interface-left"></div>
	<div id="interface-right">
		<div id="canvas"></div>
		<div class="hidden" id="loader"></div>
		<details id="interface-float-left">
			<details>
				<summary>Help</summary>
				<h4>Keyboard shortcuts</h4>
				<p>[N] Next</p>
				<p>[P] Previous</p>
				<p>[R] Report tab</p>
				<p>[F] Fit to screen</p>
				<p>[A] Anchor</p>
				<p>[S][1-3] Zoom</p>
				<p>[C][1-3] Contrast</p>
			</details>
			<summary>File</summary>
			<details>
				<summary>Add post</summary>
				<div>
				<input onfocus="disableKeymap()" onfocusout="enableKeymap()" type="number" id="add-post-input">
				<button onclick="getRemotePost(document.getElementById('add-post-input').value)">Add</button>
				</div>
			</details>
			<details id="report-tab">
				<summary>Report</summary>
				<div>
				<textarea onfocus="disableKeymap()" onfocusout="enableKeymap()" placeholder="Optional note" id="note"></textarea>
				<br>
				<button onclick="submitReport()">Submit</button>
				</div>
			</details>
		</details>
	</div>
</div>

<div id="interface-float">
	<span title="[A]" id="button-anchor" onclick="anchor()">Anchor</span>
	<span title="[F]" id="button-fit" onclick="fit()">Fit</span>
	<br>
	<span id="scale" style="cursor:inherit">Scale:
		<span title="[S,1]" id="button-scale1" class="highlighted" onclick="scale(1)">1x</span>
		<span title="[S,2]" id="button-scale2" onclick="scale(2)">2x</span>
		<span title="[S,3]" id="button-scale5" onclick="scale(5)">5x</span>
	</span>
	<br>
	<span id="contrast" style="cursor:inherit">Contrast:
		<span title="[C,1]" id="button-cont1" class="highlighted" onclick="cont(1)">1x</span>
		<span title="[C,2]"id="button-cont2" onclick="cont(2)">2x</span>
		<span title="[C,3]"id="button-cont3" onclick="cont(3)">3x</span>
	</span>
</div>

<script src="/static/scripts/compare.js"></script>
<script>
	{{if .Report}}
		reportID = {{.Report}}
	{{end}}

	gateway = {{.UserInfo.IpfsDaemon}}
	{{range .Posts}}
		addPost(postStruct(
			{{.ID}},
			{{.Hash}},
			{{.ClosestThumbnail 100}},
			{{.Dimension}},//{{with .Dimension}}{"width":{{.Width}},"height":{{.Height}}}{{else}}null{{end}},
			{{.Size}},
			{{.Mime}}
		))
	{{end}}

</script>

{{template "baseEnd"}}
